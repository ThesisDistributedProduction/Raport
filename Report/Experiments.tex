% !TeX spellcheck = en_US

\chapter{Experiments}

\newcommand{\failingTurbineNumbers}{1, 5, 10 and 30}
\newcommand{\testTurbineNumbers}{2, 21, 41, 61, 81 and 101}
\newcommand{\experiemntRunTime}{2mins}


The goal of this project was not only to build a control system that provides both scalability and availability, but also to compare it to the current solution by Siemens Windpower. 
In order to evaluate the system, we have created the experiments in the following sections.

The experiments are done using up to 3 machines connected using a 1Gbit ethernet router with IGMP support.
The experiments are run on 3 laptops, with one being used to capture test data and the other 2 optionally running a number of turbines controllers to generate traffic.
All test are run with CPU utilization on average below 90\%, this is done to keep performance consistent.
The specification of the hardware used for testing can be found in \cref{appendix:HardwareSpecification}.
Every experiment is run at least X times 

\section{PS \ref{PS:Q:CanWeDoIt}: Does our prototype work?}
We start the prototype:
\begin{itemize}
	\item Does it communicate without a central system?
	\item Does the sum of the turbines setpoints match the global setpoint? 
\end{itemize}

\section{PS \ref{PS:Q:Availlability}: Fault tolerance of the system}

The below experiment is done with a variating N number of failing turbines \failingTurbineNumbers.
The experiment has the following procedure:
\begin{enumerate}
	\item Start the system with 100 turbines.
	\item Make sure the system is stable.
	\item Kill N nodes.
	\begin{itemize}
		\item did the system discover the failed node within a 150ms timeframe?
		\item did the system adjust the setpoints for all turbines to keep the global setpoint correct?
	\end{itemize}
\end{enumerate}


\section{PS \ref{PS:Q:CanWeScale}: Scalability of regulation algorithm}
Scalability is by Bondi\cite{Bondi:2000:CSI:350391.350432} defined as \textit{the systems ability to accommodate an increasing number of elements or objects, to process growing volumes of work gracefully, and/or to be susceptible to enlargement}.

The experiments below are made to show how the number of turbines effect the regulation cycle in the decentralized system described in \cref{cha:decentralizedSystem}.
The tests are done with \testTurbineNumbers ~turbine controllers. Besides turbines we are also going to modify ''Data Wait Time Frame'' witch is a constant that defines the time a turbine controller will wait for new updates before considering the other turbine controller offline and unavailable, i.e. regulation speed.

The test system is expected to be running only one instance in a real life implementation, therefore the test machine will only run one instance and the support machines will run the rest generating system load.
The experiment is done with a variating N number of online turbines.
The following procedure is used each time the experiment is done:
\begin{enumerate}
	\item Start the system with N turbines.
	\item Make sure the system is stable.
	\item Start logging the reported regulation run time and cache read count.
	\item Stop logging after \experiemntRunTime.
\end{enumerate}

\section{PS \ref{PS:Q:HowWellDoWeScale}: Comparing decentralized with centralized}
Theses experiments seek to compare the new decentralized (see \cref{cha:decentralizedSystem}) system with the current centralized Siemens system(see \cref{cha:existingSystem}).

The experiments below are made to show how the number of turbines and regulation speed affect the regulation algorithm, memory consumption and Network traffic.
Each of these parameters behave differently when centralized compared to decentralized as seen in \cref{fig:timingCentralVSDecentral} the decentralized system does not wait for new data before doing calculations. Because of this the decentralized version has a extra parameter witch says how much data was updated before calculation was run.

\begin{figure}[b]
	%The figure show how regulation time differs central vs decantral
	\centering
	{\sffamily{Centralized approach}}
	\input{figures/tikz/timingDiagramCentralized}
	\newline
	
	{\sffamily{Decentralized approach}}
	\input{figures/tikz/timingDiagramDecntral}
	\caption{Centralized vs decentralized regulation time}
	\label{fig:timingCentralVSDecentral}
\end{figure}

	The centralized version is split into two applications a client and a server.
	What we aim to primarily compare here is the regulation therefore the client side of the application is not measured. This means that the decentralized version is at slight disadvantage.
	The following procedure is used each time the experiment is done, the procedure is done with N simulated turbines for both :

\begin{minipage}{\textwidth}
	\begin{enumerate}
		\item Start the system with N turbines.
		\item Make sure the system is stable.
		\item Start logging:
		\begin{itemize}
			\item Reported regulation run time (Central only, Decentralized is reused)
			\item Memory and Bandwidth
		\end{itemize}
		\item Stop logging after \experiemntRunTime.
		\end{enumerate}
\end{minipage}
