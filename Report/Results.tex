% !TeX spellcheck = en_US

\newcommand{\resultsFigureWidthScale}{1}

\chapter{Results}
\label{chap:results}

\section{\ref{PS:Q:Feasibility}}
Presented in \cref{fig:graphicalInterface} is shown a screenshot of the graphical interface while the decentralized solution is running 5 turbines.
The global setpoint for power production is at 2000, illustrated by the red line and global power production is illustrated by the black line.
The blue line illustrates the maximum available power production for the wind farm while the lines in the bottom around 400 is the power production of each individual turbine.

\begin{figure} [!h]
	\centering
	\includegraphics[width=0.9\textwidth,natwidth=610,natheight=642]{gui.png} 
	\captionsetup{format=plain,font=footnotesize,labelfont={bf,defaultCapFont},labelsep=quad,singlelinecheck=no}
	\caption[Graphical interface running 5 turbines]{
		\label{fig:graphicalInterface} 
		\footnotesize{%
			Graphical interface running 5 turbines.
		}
	}
\end{figure}


\section{\ref{PS:Q:Availability}}
\todo{Randomly kill client, plot a few seconds of data around the event.}

\section{\ref{PS:Q:Performance}}
\label{sec:exp:performance}
The cycle times are calculated as the difference between the receive timestamp of the oldest turbine state package and a timestamp right after the new turbine state has been sent and the turbines setpoint has been set.
The regulation cycle time with variating number of turbines are done with box plots and a line. The box plots whiskers show the extreme values max and min, the top and bottom of the box show the upper and lower quartile of the data, and the center line shows the median. The median is further highlighted by a line.

\subsection{\nameref{subsec:Exper:perfom:1}}

The results of one of the \nameref{sec:Exper:perfom} experiments plotted are plotted in \cref{fig:exp:decen:sleep,fig:exp:decen:sleep-cache}.
The experiment where performed with a variating number of internal wait times.

\begin{figure}[h]
	\centering
	\input{figures/tikz/results/Test6_decentral_cycle_msleep}
	\caption{Decentralized solution with variable wait time cycle time experiment}
	\label{fig:exp:decen:sleep}
\end{figure}

\Cref{fig:exp:decen:sleep} show the that the regulation cycle times and wait times are linearly Dependant on each other, the maximum value with wait time 10 is outside the boundaries of the plot but is calculated to $148.91~ms.$ The upper and lower quartile are close together the exception is the $10~ms.$ wait time sample, the maximum being the $20~ms.$ wait time having a difference of $1.401~ms.$ between upper and lower quantile and the minimum being $45~ms.$ wait time with a difference of $0.402~ms.$ The maximum values again with the exception of the $10~ms.$ wait time sample follow the median values, the minimum values are able to reach low regulation cycle times much lower than the wait time used in the experiment.

\begin{figure}[h]
	\centering
	\input{figures/tikz/results/Test6_decentral_cycle_msleep_cache}
	\caption{Decentralized solution with variable wait time cache reads experiment}
	\label{fig:exp:decen:sleep-cache}
\end{figure}

\Cref{fig:exp:decen:sleep-cache} show the average cache reads of the experiment.
A cache read only happens in the decentralized solution and is a consequence of the separation of receiving data in a separate thread.
The cache read happens if the wait time elapses before all turbine instances have responded with state information. The Number dos not include information of if the same turbine instance state has been read from cache multiple times.
The number of cache reads is declining, a fitted function of the plot has been put on top (red), the plot is in Matlab fitted against the function $\dfrac{a}{x + b} + c$.

\subsection{\nameref{subsec:Exper:perfom:2}}
The plots in this section relates to the second part of the \nameref{sec:Exper:perfom} experiment. In this graph the regulation cycle time is plotted against a variating number of turbines.

\begin{figure}[h]
	\centering
	\input{figures/tikz/results/Test5_decentral_cycle}
	\caption{Decentralized solution variable number of turbines experiment 1}
	\label{fig:exp:decen:turbines}
\end{figure}

\cref{fig:exp:decen:turbines} show regulation cycle time of the decentralized system compared with a variating number of turbines. The internal sleep parameter is fixed as $20~ms.$
It is seen the system performs with a constant regulation cycle time with 5 to 90 turbines, if only observing the median.
The quartiles are with the exception of the 5 turbines experiment of almost constant until 65, the same applies to the maximum values.
Regulation cycle time values are capped close to $150~ms.$ by the software which then considers the turbine offline.
At 70 turbines the maximum value sticks out notably it does look like a outlier however checking the raw data, it is not there are logged regulation cycle times for every ms value between it and the median.
It should be noted that all the data with a cycle time above $132~ms$ are collected from the same test machine.

\begin{figure}[h]
	\centering
	\input{figures/tikz/results/Test5_decentral_cycle_cache}
	\caption{Decentralized solution variable number of turbines experiment 1}
	\label{fig:exp:decen:turbines_cache}
\end{figure}

\section{\ref{PS:Q:Scalability}}

\begin{figure}[h]
	\centering
	\input{figures/tikz/results/Test4_Central_cycle}
	\caption{Centralized solution variable number of turbines experiment 1}
	\label{fig:exp:cen:turbines}
\end{figure}
